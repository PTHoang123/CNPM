{"ast":null,"code":"var _jsxFileName = \"/Users/mac/CNPM/food-delivery/src/pages/CheckOut.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// filepath: src/pages/Checkout.jsx\nimport React, { useState, useEffect } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, useStripe, useElements, CardElement } from \"@stripe/react-stripe-js\";\nimport { Container, Row, Col } from \"reactstrap\";\nimport CommonSection from \"../components/UI/CommonSection\";\nimport Helmet from \"../components/Helmet\";\nimport \"../styles/checkout.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\nconsole.log(\"Stripe key:\", process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\n\n// card test :  4242 4242 4242 4242\nfunction CheckoutForm({\n  cartItems,\n  shippingCost\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const [enterName, setEnterName] = useState(\"\");\n  const [enterEmail, setEnterEmail] = useState(\"\");\n  const [enterNumber, setEnterNumber] = useState(\"\");\n  const [enterCountry, setEnterCountry] = useState(\"\");\n  const [enterCity, setEnterCity] = useState(\"\");\n  const [postalCode, setPostalCode] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const total = cartItems.reduce((sum, it) => sum + it.price * it.quantity, 0);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!enterEmail || !enterEmail.includes(\"@\")) {\n      alert(\"Please enter a valid email\");\n      return;\n    }\n    setLoading(true);\n    const res = await fetch(\"http://localhost:8000/api/payments/create-checkout-session\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        items: cartItems.map(it => ({\n          product_code: it.product_code,\n          title: it.title,\n          price: it.price,\n          quantity: it.quantity,\n          imageUrl: it.image\n        })),\n        shippingCost,\n        customer: {\n          name: enterName,\n          email: enterEmail\n        }\n      })\n    });\n    const {\n      sessionId\n    } = await res.json();\n    // 2) Redirect to Stripe Checkout\n    const {\n      error\n    } = await stripe.redirectToCheckout({\n      sessionId\n    });\n    if (error) alert(error.message);\n    setLoading(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"checkout__form\",\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form__group\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"email\",\n        placeholder: \"Enter your email\",\n        required: true,\n        onChange: e => setEnterEmail(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 8\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 8\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form__group\",\n      children: /*#__PURE__*/_jsxDEV(CardElement, {\n        options: {\n          hidePostalCode: true\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"addTOCart__btn\",\n      disabled: loading || !stripe,\n      children: loading ? \"Processing…\" : `Pay $${(total + shippingCost).toFixed(2)}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"ZdXsXoSI+BNIimqGVtMjJwGRYxg=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nconst Checkout = () => {\n  _s2();\n  const [cartItems, setCartItems] = useState([]);\n  const shippingCost = 30;\n  useEffect(() => {\n    fetch(\"http://localhost:8000/api/cart\").then(r => r.json()).then(setCartItems);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Helmet, {\n    title: \"Checkout\",\n    children: [/*#__PURE__*/_jsxDEV(CommonSection, {\n      title: \"Checkout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            lg: \"8\",\n            md: \"6\",\n            children: /*#__PURE__*/_jsxDEV(Elements, {\n              stripe: stripePromise,\n              children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n                cartItems: cartItems,\n                shippingCost: shippingCost\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n};\n_s2(Checkout, \"yMyLm0mTOdUD4xRL2vnEhQFbjeY=\");\n_c2 = Checkout;\nexport default Checkout;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Checkout\");","map":{"version":3,"names":["React","useState","useEffect","loadStripe","Elements","useStripe","useElements","CardElement","Container","Row","Col","CommonSection","Helmet","jsxDEV","_jsxDEV","stripePromise","process","env","REACT_APP_STRIPE_PUBLISHABLE_KEY","console","log","CheckoutForm","cartItems","shippingCost","_s","stripe","elements","enterName","setEnterName","enterEmail","setEnterEmail","enterNumber","setEnterNumber","enterCountry","setEnterCountry","enterCity","setEnterCity","postalCode","setPostalCode","loading","setLoading","total","reduce","sum","it","price","quantity","handleSubmit","e","preventDefault","includes","alert","res","fetch","method","headers","body","JSON","stringify","items","map","product_code","title","imageUrl","image","customer","name","email","sessionId","json","error","redirectToCheckout","message","className","onSubmit","children","type","placeholder","required","onChange","target","value","fileName","_jsxFileName","lineNumber","columnNumber","options","hidePostalCode","disabled","toFixed","_c","Checkout","_s2","setCartItems","then","r","lg","md","_c2","$RefreshReg$"],"sources":["/Users/mac/CNPM/food-delivery/src/pages/CheckOut.jsx"],"sourcesContent":["// filepath: src/pages/Checkout.jsx\nimport React, { useState, useEffect } from \"react\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  useStripe,\n  useElements,\n  CardElement,\n} from \"@stripe/react-stripe-js\";\nimport { Container, Row, Col } from \"reactstrap\";\nimport CommonSection from \"../components/UI/CommonSection\";\nimport Helmet from \"../components/Helmet\";\nimport \"../styles/checkout.css\";\n\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\nconsole.log(\"Stripe key:\", process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\n\n// card test :  4242 4242 4242 4242\nfunction CheckoutForm({ cartItems, shippingCost }) {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const [enterName, setEnterName] = useState(\"\");\n  const [enterEmail, setEnterEmail] = useState(\"\");\n  const [enterNumber, setEnterNumber] = useState(\"\");\n  const [enterCountry, setEnterCountry] = useState(\"\");\n  const [enterCity, setEnterCity] = useState(\"\");\n  const [postalCode, setPostalCode] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const total = cartItems.reduce(\n    (sum, it) => sum + it.price * it.quantity,\n    0\n  );\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!enterEmail || !enterEmail.includes(\"@\")) {\n      alert(\"Please enter a valid email\");\n      return;\n    }\n    setLoading(true);\n    const res = await fetch(\n  \"http://localhost:8000/api/payments/create-checkout-session\",\n  {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      items: cartItems.map((it) => ({\n        product_code: it.product_code,\n        title: it.title,\n        price: it.price,\n        quantity: it.quantity,\n        imageUrl: it.image,\n      })),\n      shippingCost,\n      customer: {\n        name: enterName,\n        email: enterEmail,\n      },\n    }),\n  }\n);\n    const { sessionId } = await res.json();\n    // 2) Redirect to Stripe Checkout\n    const { error } = await stripe.redirectToCheckout({ sessionId });\n    if (error) alert(error.message);\n    setLoading(false);\n  };\n\n  return (\n    <form className=\"checkout__form\" onSubmit={handleSubmit}>\n      {/* shipping fields */}\n      {/* … other shipping fields … */}\n       <div className=\"form__group\">\n       <input\n         type=\"email\"\n         placeholder=\"Enter your email\"\n         required\n         onChange={(e) => setEnterEmail(e.target.value)}\n       /></div>\n      {/* Stripe card input */}\n      <div className=\"form__group\">\n        <CardElement options={{ hidePostalCode: true }} />\n      </div>\n      <button type=\"submit\" className=\"addTOCart__btn\" disabled={loading || !stripe}>\n        {loading ? \"Processing…\" : `Pay $${(total + shippingCost).toFixed(2)}`}\n      </button>\n    </form>\n  );\n}\n\nconst Checkout = () => {\n  const [cartItems, setCartItems] = useState([]);\n  const shippingCost = 30;\n\n  useEffect(() => {\n    fetch(\"http://localhost:8000/api/cart\")\n      .then((r) => r.json())\n      .then(setCartItems);\n  }, []);\n\n  return (\n    <Helmet title=\"Checkout\">\n      <CommonSection title=\"Checkout\" />\n      <section>\n        <Container>\n          <Row>\n            <Col lg=\"8\" md=\"6\">\n              <Elements stripe={stripePromise}>\n                <CheckoutForm cartItems={cartItems} shippingCost={shippingCost} />\n              </Elements>\n            </Col>\n            {/* summary panel… */}\n          </Row>\n        </Container>\n      </section>\n    </Helmet>\n  );\n};\n\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}